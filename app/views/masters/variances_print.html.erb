<style>

  *,
  *:before,
  *:after,
  *:first-letter,
  p:first-line,
  div:first-line,
  blockquote:first-line,
  li:first-line {
    background: transparent !important;
    color: #000 !important; /* Black prints faster:
                   http://www.sanbeiji.com/archives/953 */
    box-shadow: none !important;
    text-shadow: none !important;
  }

  a,
  a:visited { text-decoration: underline; }

  a[href]:after { content: " (" attr(href) ")"; }

  abbr[title]:after { content: " (" attr(title) ")"; }

  /*
   * Don't show links that are fragment identifiers,
   * or use the `javascript:` pseudo protocol
   */

  a[href^="#"]:after,
  a[href^="javascript:"]:after { content: ""; }

  pre { white-space: pre-wrap !important; }

  pre,
  blockquote {
    border: 1px solid #999;
    page-break-inside: avoid;
  }

  /*
   * Printing Tables:
   * http://css-discuss.incutio.com/wiki/Printing_Tables
   */

  thead { display: table-header-group; }
  th { padding: 4px; text-align: left; font-size: 10px; }
  table {width:100%;border-spacing:0;position:absolute; }
  td { padding: 4px; text-align: left;font-size: 10px; page-break-inside: avoid; }
  tr:last-child td{page-break-inside: avoid;}
  
  td,
  tr,
  img { page-break-inside: avoid; }


  h2,
  h3 {
    orphans: 3;
    widows: 3;
  }

  h2,
  h3 { page-break-after: avoid; }

  /**
   * HIDE certain elements completely
   */
  .site-navigation {
    display: none;
  }

  /**
   * Or go Nuclear and use this:
   * from: https://medium.com/@matuzo/i-totally-forgot-about-print-style-sheets-f1e6604cfd6#.9de6r4yhr
   *
   *   body > *:not(main) { display: none; }
   *
   */

   table.print-friendly tr td, table.print-friendly tr th {
        page-break-inside: avoid !important;
    }

   .left_header {
    margin-top: 0px;
    margin-bottom: 0px;
    font-size: 10px;
   }

   .thrdbox {
    text-align: right;
    width: 100%;
    position: absolute;
    top: 10px;
    font-size: 10px;
    right: 10px;
  }

  .fourthbox {
    text-align: right;
    width: 100%;
    position: absolute;
    top: 60px;
    font-size: 10px;
    right: 10px;
  }

  .try {
    margin-block-start: 0px;
    margin-block-end: 0px;
    margin-inline-start: 0px;
    margin-inline-end: 0px;
  }

 .space {
  padding-bottom: 0px;
  padding-top: 2px;
  padding-left: 0px;
  padding-right: 0px;
}
  
.quantity {
  text-align: right;
}

.line {
  text-align: center;
}

.lining {
  border-top: 1px solid #000;
  border-bottom: 1px solid #000;
  padding-top: 10px;
}
</style>


<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <%= favicon_link_tag 'favicon.ico' %>
  </head>

  <body style="margin-top: 0px;
  margin-right: 0px;
  margin-bottom: 0px;
  margin-left: 0px;">

<table class="table table-striped table-hover print-friendly">
<thead>
<tr>
    <th colspan="3"><%= image_tag display_barcode(@variances.first.master.CountName) %></th>
    <th></th>
    <th style = "text-align: center; font-size: 15px;">รายงาน Variance</th>
    <th></th>
    <th></th>
    <th></th>
    <th></th>
    <th></th>
    <th></th>
    <th></th>
    <th style="text-align:right" colspan="2"><%= Time.now.strftime('%d/%m/%Y %H:%M:%S') %></th>
  </tr>
  <tr>
    <th colspan="2">ใบนับเลขที่: <%= @variances.first.master.CountName %></th>
    <th></th>
    <th></th>
    <th style = "text-align: center; font-size: 13px;">CRC Pooled Stocktake</th>
    <th></th>
    <th></th>
    <th></th>
    <th></th>
    <th></th>
    <th></th>
    <th></th>
    <th style="text-align:right;" colspan="2"><%= params[:dept].present? ? params[:dept] : "All departments" %></th>
  </tr>
  <tr>
    <th>StoreCode: <%= @variances.first.master.StoreCode %></th>
    <th></th>
    <th></th>
    <th></th>
    <th style = "text-align: center; font-size: 13px;"><span style="padding-right: 50px">มูลค่าขาด: <%= number_with_delimiter(params[:minimum_loss_value]) %></span><span style="padding-right: 50px">ถึง: <%= number_with_delimiter(params[:maximum_loss_value]) %></span></th>
    <th></th>
    <th></th>
    <th></th>
    <th></th>
    <th></th>
    <th></th>
    <th></th>
    <th></th>
    <th></th>
  </tr>
  <tr>
    <th colspan="3" style="padding-bottom: 10px;">StoreName: <%= @variances.first.master.StoreName %></th>
    <th></th>
    <th style = "text-align: center; font-size: 13px;"><span style="padding-right: 50px">มูลค่าเกิน: <%= number_with_delimiter(params[:minimum_gain_value]) %></span><span style="padding-right: 50px">ถึง: <%= number_with_delimiter(params[:maximum_gain_value]) %></th>
    <th></th>
    <th></th>
    <th></th>
    <th></th>
    <th></th>
    <th></th>
    <th></th>
    <th style="text-align:right;" colspan="2">ประเภทสินค้า: Credit</th>
  </tr>
<tr>
  <th class="lining">Location</th>
  <th class="lining">SKU</th>
  <th class="lining">IBC</th>
  <th class="lining">SBC</th>
  <th class="lining">ชื่อสินค้า</th>
  <th class="lining">ยี่ห้อ</th>
  <th class="lining">รุ่น</th>
  <th class="lining">Stock</th>
  <th class="lining">นับได้</th>
  <th class="lining">Variance</th>
  <th class="lining">VarianceCost</th>
  <th class="lining">นับจริง</th>
  <th class="lining">ลงชื่อตรวจนับ</th>
  <th class="lining">ลงชื่อ LP</th>
</tr>
</thead>
<tbody>

<% @variances.find_in_batches do |bulk| %>
  <% bulk.each do |r| %>
<tr>
  <td class="space"><%= r.LOCATION %></td>
  <td class="space"><%= r.BARCODE %></td>
  <td class="space"><%= r.BARCODE %></td>
  <td class="space"><%= r.BARCODE %></td>
  <td class="space"><%= r.master.ProductName %></td>
  <td class="space"><%= r.master.Brand %></td>
  <td class="space"><%= r.master.Model %></td>
  <td class="space quantity"><%= number_with_delimiter(r.STOCK) %></td>
  <td class="space quantity"><%= number_with_delimiter(r.QNT) %></td>
  <td center;" class="space quantity"><%= number_with_delimiter(r.VarianceDiff) %></td>
  <td center;" class="space quantity"><%= number_with_delimiter(r.VarianceCost) %></td>
  <td></td>
  <td></td>
  <td></td>
</tr>
<tr>
  <td colspan="2" class="space"><%= image_tag display_barcode(r.LOCATION)%></td>
  <td colspan="2" class="space"><%= image_tag display_barcode(r.BARCODE) %></td>
  <td></td>
  <td></td>
  <td></td>
  <td></td>
  <td></td>
  <td></td>
  <td></td>
  <td class="space line">----------</td>
  <td class="space line">----------</td>
  <td class="space line">----------</td>
</tr>
<% end %>
<% end %>
</tbody>
<tfoot>
  <tr>
    <td colspan="4"></td>
    <td colspan="4"></td>
    <td colspan="5"></td>
  </tr>
  <tr>
    <td style = "text-align: center" class="space line" colspan="4">(---------------------------------------)</td>
    <td style = "text-align: center"  class="space line" colspan="4">(--------------------------------------)</td>
    <td style = "text-align: center"  class="space line" colspan="5">(--------------------------------------)</td>
  </tr>
  <tr>
    <td style = "text-align: center"  class="space" colspan="4"><b>ผู้ตรวจนับ</b></td>
    <td style = "text-align: center"  class="space" colspan="4"><b>ผู้ตรวสอบ (Auditor)</b></td>
    <td style = "text-align: center"  class="space" colspan="5"><b>ผู้แก้ไข (Acc)</b></td>
  </tr>
</tfoot>
</table>
</body>
</html>

<script>
  window.print();
</script>
